<template>    <div class="upload-option">        <div v-if="!upload" class="upload-area" @drop.prevent.stop="dropUploadFile($event)" @dragover.stop.prevent>            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"                 class="header-upload-entry__icon">                <path                    d="M12.0824 10H14.1412C15.0508 10 15.7882 10.7374 15.7882 11.6471V12.8824C15.7882 13.792 15.0508 14.5294 14.1412 14.5294H3.84707C2.93743 14.5294 2.20001 13.792 2.20001 12.8824V11.6471C2.20001 10.7374 2.93743 10 3.84707 10H5.90589"                    stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path>                <path d="M8.99413 11.2353L8.99413 3.82353" stroke="currentColor" stroke-width="1.7"                      stroke-linecap="round" stroke-linejoin="round"></path>                <path d="M12.0823 6.29413L8.9941 3.20589L5.90587 6.29413" stroke="currentColor" stroke-width="1.7"                      stroke-linecap="round" stroke-linejoin="round"></path>            </svg>            <span class="upload-intro">拖拽到此处也可上传</span>            <div class="upload-button" @click="openUpload">                上传视频            </div>            <input type="file" ref="file" accept=".mp4,.flv,.avi,.wmv,.mov,.webm,.mpeg4,.ts,.mpg,.rm,.rmvb,.mkv,.m4v"                   style="display: none" @change="uploadClick">        </div>        <div v-show="upload" class="upload-file">            <div class="filename">{{ filename }}</div>            <div class="process">                <div class="upload-process" ref="progress"></div>            </div>            <div class="input">                <div class="sign">标题</div>                <div class="input-container">                    <div class="input-instance">                        <input class="input-val" type="text" v-model="dynamic.title">                    </div>                </div>            </div><!--            <div class="input">--><!--                <div class="sign">封面</div>--><!--                <div class="input-container">--><!--                    <div class="input-instance">--><!--                        <input class="input-val" type="text">--><!--                    </div>--><!--                </div>--><!--            </div>-->            <div class="input">                <div class="sign">简介</div>                <div class="input-container">                    <div class="input-instance">                        <input class="input-val" type="text" v-model="dynamic.introduce">                    </div>                </div>            </div>            <div class="input">                <div class="sign">内容</div>                <div class="input-container">                    <div class="input-instance">                        <input class="input-val" type="text" v-model="dynamic.content">                    </div>                </div>            </div>            <div class="button">                <div class="upload-button" @click="submit">立即投稿</div>            </div>        </div>    </div></template><script>import {getCurrentInstance, onMounted, ref} from 'vue'import {BASEURL, SubmitDynamic, UploadVideoURL} from '@/utils/Constant'import axios from 'axios'import request from '@/utils/request'export default {    name: 'UploadVideo',    setup() {        let file        let progress        let upload = ref(false)        let filename = ref('')        let dynamic = ref({            type: 1,        })        onMounted(() => {            file = getCurrentInstance().refs.file            progress = getCurrentInstance().refs.progress        })        function dropUploadFile(event) {            let item = event.dataTransfer.items[0]            let entry = item.webkitGetAsEntry()            if (item.kind === "file" && entry.isFile) {                let file = item.getAsFile()                if (file.type === 'video/mp4' || file.type === 'video/x-matroska' || file.type === 'video/avi'){                    uploadFile(file)                }            }        }        function openUpload() {            file.click()        }        function uploadClick() {            uploadFile(file.files[0])        }        function uploadFile(file){            upload.value = true            filename.value = file.name            let formData = new FormData()            formData.append('file', file)            axios({                url: BASEURL + UploadVideoURL,                method: 'post',                headers: {'Content-Type': 'multipart/form-data', 'Authorization': localStorage.getItem('token')},                data: formData,                onUploadProgress: (progressEvent) => {                    if (progressEvent.loaded !== progressEvent.total) {                        progress.style.width = (progressEvent.loaded / progressEvent.total).toFixed(2) * 100 + '%'                    } else {                        progress.style.width = '100%'                        progress.style.backgroundColor = '#43ce5b'                    }                },            }).then(res => {                if (res.data.code === 0) {                    dynamic.value.src = res.data.data                }            })        }        function submit(){            request.post(SubmitDynamic, dynamic.value).then(res => {                if (res.data.code === 0) {                    console.log(res.data.data)                }            })        }        return {            dropUploadFile,            openUpload,            uploadClick,            uploadFile,            submit,            upload,            dynamic,            filename,        }    },}</script><style scoped>.upload-option {    margin-top: 20px;    display: flex;    justify-content: center;    align-items: center;    flex-direction: column;}.upload-area {    width: 826px;    height: 260px;    border: #cccccc dashed 2px;    display: flex;    justify-content: center;    align-items: center;    flex-direction: column;    color: #555555;}.upload-area svg {    color: #999999;    width: 40px;    height: 40px;}.upload-intro {    color: #555555;    font-size: 14px;}.upload-button {    margin-top: 20px;    width: 200px;    height: 44px;    cursor: pointer;    background: #00a1d6;    border-radius: 4px;    display: flex;    justify-content: center;    align-items: center;    color: white;    font-size: 14px;}.upload-file-list{    display: flex;    flex-direction: column;}.upload-file{    display: flex;    flex-direction: column;}.process{    width: 826px;    height: 3px;    background-color: #e5e5e5;}.upload-process{    height: 3px;    background-color: #23aedb;}.input-container{    background: hsla(0, 0%, 84.7%, 0);    border: 1px solid #ccd0d7;    border-radius: 4px;    padding: 0 12px;    display: flex;    align-items: center;    flex-wrap: wrap;    transition: border .3s ease;    flex: 7;}.input-instance{    min-width: 200px;    margin: 6px 0;}.input-val {    display: block;    width: 100%;    color: #222;    line-height: 22px;    height: 22px;    font-size: 14px;    outline: 0;    -webkit-appearance: none;    -moz-appearance: none;    appearance: none;    border: 0;    background-color: transparent;}.input {    display: flex;    margin-top: 20px;}.sign{    flex: 1;    display: flex;    justify-content: center;    align-items: center;}.button{    display: flex;    justify-content: center;    align-items: center;}</style>