<template>    <div class="top">        <div class="title">回复我的</div>    </div>    <div class="card" ref="card">        <MessageItem v-for="item in list" :item="item"/>    </div></template><script>import MessageItem from '@/components/MessageItem'import {getCurrentInstance, onBeforeUnmount, onMounted, reactive, ref} from 'vue'import request from '@/utils/request'import {GetReply} from '@/utils/Constant'export default {    name: 'MessageReply',    components: {MessageItem},    setup() {        let pageSize = ref(20)        let list = reactive([])        let isLoading = false        let isEnd = false        let card        function init(){            request.post(GetReply, {                pageSize: pageSize.value,            }).then(res => {                if (res.data.code === 0) {                    list.push(...res.data.data)                }            })        }        function scrollLoad() {            try {                if (!isLoading && !isEnd) {                    if (card.scrollHeight - card.scrollTop - card.clientHeight < 50) {                        let data = {                            pageSize: pageSize.value,                            commentId: list[list.length - 1].comment.id                        }                        isLoading = true                        request.post(GetReply, data).then(res => {                            if (res.data.code === 0) {                                list.push(...res.data.data)                                if (res.data.data.length === 0) {                                    isEnd = true                                }                            }                        }).finally(() => {                            isLoading = false                        })                    }                }            } catch (e) {            }        }        onMounted(() => {            card = getCurrentInstance().refs.card            card.addEventListener('scroll', scrollLoad)            init()        })        onBeforeUnmount(() => {            card.removeEventListener('scroll', scrollLoad)        })        return {            list,        }    },}</script><style scoped>.top {    width: calc(100% - 140px);    height: 42px;    background-color: white;    border-radius: 4px;    display: flex;    align-items: center;    box-shadow: 0 2px 4px 0 rgba(121, 146, 185, 0.54);}.title {    padding: 0 16px;    color: #666666;}.card {    margin-top: 10px;    width: calc(100% - 140px);    height: calc(100vh - 64px - 42px - 30px);    background-color: white;    border-radius: 4px;    display: flex;    align-items: center;    box-shadow: 0 2px 4px 0 rgba(121, 146, 185, 0.54);    min-height: 300px;    overflow-y: auto;    flex-direction: column;}</style>