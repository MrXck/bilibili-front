<template>    <div class="item">        <div class="user">            <img class="avatar" @click="toUser(item.user.id)" :src="item.user.avatar === '' ? logo : item.user.avatar"                 alt="">        </div>        <div class="detail">            <div class="username" @click="toUser(item.user.id)">{{ item.user.nickname }}</div>            <div class="comment-content">{{ item.comment.content }}</div>            <div class="option">                <div class="time">{{ item.comment.createTime.replace('T', ' ').split('.')[0] }}</div>                <div class="good">                    <span v-show="!isStar" @click="star">                        <svg t="1636093575017" class="icon" viewBox="0 0 1024 1024"                             version="1.1"                             xmlns="http://www.w3.org/2000/svg" p-id="3323" width="200" height="200"><path                            d="M594.176 151.168a34.048 34.048 0 0 0-29.184 10.816c-11.264 13.184-15.872 24.064-21.504 40.064l-1.92 5.632c-5.632 16.128-12.8 36.864-27.648 63.232-25.408 44.928-50.304 74.432-86.208 97.024-23.04 14.528-43.648 26.368-65.024 32.576v419.648a4569.408 4569.408 0 0 0 339.072-4.672c38.72-2.048 72-21.12 88.96-52.032 21.504-39.36 47.168-95.744 63.552-163.008a782.72 782.72 0 0 0 22.528-163.008c0.448-16.832-13.44-32.256-35.328-32.256h-197.312a32 32 0 0 1-28.608-46.336l0.192-0.32 0.64-1.344 2.56-5.504c2.112-4.8 5.12-11.776 8.32-20.16 6.592-17.088 13.568-39.04 16.768-60.416 4.992-33.344 3.776-60.16-9.344-84.992-14.08-26.688-30.016-33.728-40.512-34.944zM691.84 341.12h149.568c52.736 0 100.864 40.192 99.328 98.048a845.888 845.888 0 0 1-24.32 176.384 742.336 742.336 0 0 1-69.632 178.56c-29.184 53.44-84.48 82.304-141.76 85.248-55.68 2.88-138.304 5.952-235.712 5.952-96 0-183.552-3.008-244.672-5.76-66.432-3.136-123.392-51.392-131.008-119.872a1380.672 1380.672 0 0 1-0.768-296.704c7.68-72.768 70.4-121.792 140.032-121.792h97.728c13.76 0 28.16-5.504 62.976-27.456 24.064-15.104 42.432-35.2 64.512-74.24 11.904-21.184 17.408-36.928 22.912-52.8l2.048-5.888c6.656-18.88 14.4-38.4 33.28-60.416a97.984 97.984 0 0 1 85.12-32.768c35.264 4.096 67.776 26.88 89.792 68.608 22.208 42.176 21.888 84.864 16 124.352a342.464 342.464 0 0 1-15.424 60.544z m-393.216 477.248V405.184H232.96c-40.448 0-72.448 27.712-76.352 64.512a1318.912 1318.912 0 0 0 0.64 282.88c3.904 34.752 32.96 61.248 70.4 62.976 20.8 0.96 44.8 1.92 71.04 2.816z"                            p-id="3324" fill="#9499a0"></path></svg>                        {{ starNum }}                    </span>                    <span v-show="isStar" @click="unStar">                        <svg t="1636093991833" class="icon" viewBox="0 0 1024 1024"                             version="1.1"                             xmlns="http://www.w3.org/2000/svg" p-id="4447" width="200" height="200"><path                            d="M860.032 341.12h-182.08c7.488-17.408 14.72-38.528 18.048-60.544 5.952-39.872 4.992-87.36-18.368-129.088-21.76-38.848-50.304-60.928-83.52-61.376-30.72-0.384-53.888 18.176-65.728 33.408a199.296 199.296 0 0 0-32.064 59.264l-1.92 5.184c-5.44 14.976-10.88 29.952-23.04 51.456-19.712 34.816-48.832 56.128-77.696 74.368a391.936 391.936 0 0 1-30.976 17.92v552.448a4621.952 4621.952 0 0 0 351.872-5.312c51.264-2.752 100.672-28.544 127.488-76.032 24.32-43.136 55.168-108.16 74.368-187.264 20.416-84.16 24.64-152.704 24.576-195.968-0.128-46.336-38.72-78.4-80.96-78.4z m-561.344 541.312V341.12H215.808c-59.712 0-113.408 42.048-120.896 104.32a1376 1376 0 0 0 0.64 330.368c7.36 58.688 56.128 100.032 113.024 102.848 25.024 1.28 55.552 2.56 90.112 3.712z"                            p-id="4448" fill="#00aeec"></path></svg>                        {{ starNum }}                    </span>                </div>                <!--                <div class="step">踩 <span>2</span></div>-->                <div class="reply" @click="isComment = !isComment">                    <span>回复</span>                </div>            </div>            <div v-show="isComment" class="comment">                <img class="user" :src="user.avatar !== '' ? user.avatar : logo" alt="">                <textarea v-model="content" rows="2"></textarea>                <div class="button" @click="addComment">发表评论</div>            </div>            <div class="reply-comment">                <ReplyComment :rootId="item.comment.id" :item="reply" v-for="reply in replyList"                              :key="reply.comment.id"/>            </div>            <Pagination v-if="total >= 2" :total="total" :pageNum="pageNum" @update="updatePage"/>        </div>    </div></template><script>import logo from '@/assets/logo.png'import ReplyComment from '@/components/ReplyComment'import request from '@/utils/request'import {AddDynamicComment, GetDynamicComment, GetStarNumByCommentId, Star, UnStar} from '@/utils/Constant'import {onMounted, reactive, ref} from 'vue'import {useMainStore} from '@/store'import {useRouter} from 'vue-router'import Pagination from '@/components/Pagination'export default {    name: 'CommentItem',    components: {Pagination, ReplyComment},    props: {        item: {            type: Object,        },    },    setup(props) {        let pageNum = ref(1)        let pageSize = ref(10)        let total = ref(0)        let replyList = reactive([])        let user = JSON.parse(localStorage.getItem('user'))        let content = ref('')        let isComment = ref(false)        let mainStore = useMainStore()        let router = useRouter()        let starNum = ref(0)        let isStar = ref(false)        function addComment() {            if (content.value !== '') {                request.post(AddDynamicComment, {                    content: content.value,                    dynamicId: props.item.comment.dynamicId,                    rootId: props.item.comment.id,                    toUserId: props.item.user.id,                }).then(res => {                    if (res.data.code === 0) {                        content.value = ''                        mainStore.message('回复成功', 'success')                        props.item.push({                            user: user,                            comment: res.data.data,                        })                    }                })            }        }        function init() {            request.post(GetDynamicComment, {                rootId: props.item.comment.id,                dynamicId: props.item.comment.dynamicId,                pageNum: pageNum.value,                pageSize: pageSize.value,            }).then(res => {                if (res.data.code === 0) {                    replyList.length = 0                    let list = res.data.data                    total.value = list.splice(0, 1)[0].page.pages                    replyList.push(...list)                }            })            request.get(`${GetStarNumByCommentId}/${props.item.comment.id}`).then(res => {                if (res.data.code === 0) {                    starNum.value = res.data.data.starNum                    isStar.value = res.data.data.isStar                }            })        }        function toUser(id) {            window.open(router.resolve(`/space/${id}`).href, '_blank')        }        onMounted(() => {            init()        })        function updatePage(value) {            pageNum.value = value            init()        }        function star() {            request.post(`${Star}`, {                commentId: props.item.comment.id,                isStaredUserId: props.item.comment.userId            }).then(res => {                if (res.data.code === 0) {                    isStar.value = true                    starNum.value = starNum.value + 1                }            })        }        function unStar() {            request.post(`${UnStar}`, {                commentId: props.item.comment.id,            }).then(res => {                if (res.data.code === 0) {                    isStar.value = false                    starNum.value = starNum.value - 1                }            })        }        return {            logo,            user,            content,            isComment,            replyList,            pageNum,            total,            starNum,            isStar,            addComment,            toUser,            updatePage,            star,            unStar,        }    },}</script><style scoped>.item {    display: flex;    margin-top: 30px;}.reply-comment {    width: 100%;}.user {    margin-right: 10px;}.avatar {    width: 60px;    height: 60px;    border-radius: 50%;    cursor: pointer;}.detail {    display: flex;    flex-direction: column;    font-size: 14px;    justify-content: space-around;    width: calc(100% - 100px);    border-bottom: #e5e9ef solid 1px;    padding-bottom: 4px;    align-items: flex-start;}.detail > div {    margin-bottom: 10px;}.username {    font-size: 12px;    color: #6d757a;    font-weight: bold;    cursor: pointer;}.option {    display: flex;    font-size: 12px;    color: #a0a9b0;}.option > div {    width: 120px;}.good {    display: flex;    justify-content: center;}.good span {    display: flex;    cursor: pointer;    align-items: center;}.good svg {    width: 14px;    height: 14px;}.good span:hover {    color: #23aedb;}.good span:hover path {    fill: #23aedb;}.step {    cursor: pointer;}.reply span {    cursor: pointer;}.step:hover {    color: #23aedb;}.reply span:hover {    color: #23aedb;}.comment-content {    text-overflow: ellipsis;    font-size: 14px;}textarea {    border: #23aedb solid 1px;    outline: none;    resize: none;    border-radius: 4px;    padding: 10px;    height: calc(100% - 20px);    flex: 11;}.comment {    display: flex;    margin-top: 20px;    margin-bottom: 20px !important;    width: 100%;}.button {    margin-right: 40px;    background-color: #23aedb;    padding: 6px;    font-size: 14px;    -webkit-line-clamp: 2;    line-clamp: 2;    width: 40px;    text-align: center;    color: white;    margin-left: 10px;    border-radius: 4px;    display: flex;    justify-content: center;    align-items: center;    cursor: pointer;}.user {    width: 50px;    height: 50px;    border-radius: 50%;}</style>